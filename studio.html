<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PanelForge Studio - Create and customize your comic characters with style presets and detailed controls.">
    <meta name="keywords" content="studio, character creator, style selector, comic characters, PanelForge">
    <link rel="canonical" href="https://panelforge.com/studio">
    <title>Studio - PanelForge</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="app.js" defer></script>
    
</head>
<body>
    <a href="#main" class="skip-link">Skip to main content</a>

    <div class="glow-curve curve-1"></div>
    <div class="glow-curve curve-2"></div>
    <div class="glow-curve curve-3"></div>

    <header class="pf-header" data-pf="header" role="banner" aria-label="Site header">
        <div class="header-container">
            <a href="index.html" class="logo" aria-label="PanelForge Home">Panel<span>Forge</span></a>

            <nav class="pf-nav" data-pf="nav" role="navigation" aria-label="Main navigation">
                <button class="mobile-menu-toggle pf-mobile-toggle" data-pf="mobile-toggle" aria-expanded="false" aria-controls="pf-mobile-menu" aria-label="Toggle navigation menu">
                    ?
                </button>
                <ul class="nav-menu pf-mobile-menu" id="pf-mobile-menu" role="menu" aria-hidden="true">
                    <li><a class="nav-link pf-nav-link" data-pf="nav-link" data-nav-key="home" href="index.html">Home</a></li>
                    <li><a class="nav-link pf-nav-link" data-pf="nav-link" data-nav-key="create" href="create.html">Create</a></li>
                    <li><a class="nav-link pf-nav-link active" data-pf="nav-link" data-nav-key="studio" href="studio.html" aria-current="page">Studio</a></li>
                    <li><a class="nav-link pf-nav-link" data-pf="nav-link" data-nav-key="storyboard" href="storyboard.html">Storyboard</a></li>
                    <li><a class="nav-link pf-nav-link" data-pf="nav-link" data-nav-key="preview" href="preview.html">Preview</a></li>
                    <li><a class="nav-link pf-nav-link" data-pf="nav-link" data-nav-key="export" href="export.html">Export</a></li>
                </ul>
                <div class="nav-actions" role="group" aria-label="Header actions">
                    <button class="btn-header" title="Generate character">Generate</button>
                </div>
            </nav>
        </div>
    </header>

    <main id="main" data-pf="main" class="pf-main" role="main">
        <div class="container">
            <div class="studio-layout">
                <!-- Left: Character Grid -->
                <section class="character-grid-section" aria-labelledby="character-grid-heading">
                    <div class="section-header">
                        <h1 id="character-grid-heading" class="section-title">Character Studio</h1>
                    </div>

                    <div class="character-grid" role="list" aria-label="Character selection grid">
                        <!-- Male character cards -->
                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="male-1" data-card-id="male-1" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/8cf60bf6-56d6-4cd0-a086-1a4eb000d555.jpg" alt="Male character 1">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>85</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>75</span>
                                </div>
                            </div>
                        </div>

                        <!-- Female character cards -->
                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="female-1" data-card-id="female-1" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/ef549fac-1013-4e1e-ac13-e1eab2744bc5.jpg" alt="Female character 1">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>85</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>75</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="male-2" data-card-id="male-2" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/8cf60bf6-56d6-4cd0-a086-1a4eb000d555.jpg" alt="Male character 2">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>85</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>78</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="female-2" data-card-id="female-2" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/ef549fac-1013-4e1e-ac13-e1eab2744bc5.jpg" alt="Female character 2">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>85</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>75</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="male-3" data-card-id="male-3" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/8cf60bf6-56d6-4cd0-a086-1a4eb000d555.jpg" alt="Male character 3">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>85</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>75</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="female-3" data-card-id="female-3" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/ef549fac-1013-4e1e-ac13-e1eab2744bc5.jpg" alt="Female character 3">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>85</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>75</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="female-4" data-card-id="female-4" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/ef549fac-1013-4e1e-ac13-e1eab2744bc5.jpg" alt="Female character 4">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>90</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>75</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="male-4" data-card-id="male-4" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/8cf60bf6-56d6-4cd0-a086-1a4eb000d555.jpg" alt="Male character 4">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>75</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>85</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="female-5" data-card-id="female-5" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/ef549fac-1013-4e1e-ac13-e1eab2744bc5.jpg" alt="Female character 5">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>85</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>70</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="male-5" data-card-id="male-5" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/8cf60bf6-56d6-4cd0-a086-1a4eb000d555.jpg" alt="Male character 5">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>75</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>85</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="male-6" data-card-id="male-6" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/8cf60bf6-56d6-4cd0-a086-1a4eb000d555.jpg" alt="Male character 6">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>78</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>85</span>
                                </div>
                            </div>
                        </div>

                        <div class="character-card pf-card" role="listitem" tabindex="0" data-character="female-6" data-card-id="female-6" data-pf="card">
                            <div class="character-card-image">
                                <img src="https://im.runware.ai/image/ws/2/ii/ef549fac-1013-4e1e-ac13-e1eab2744bc5.jpg" alt="Female character 6">
                            </div>
                            <div class="character-card-stats">
                                <div class="stat-badge">
                                    <span class="stat-label">STR</span>
                                    <span>85</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">DEX</span>
                                    <span>80</span>
                                </div>
                                <div class="stat-badge">
                                    <span class="stat-label">INT</span>
                                    <span>75</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Right: Inspector/Controls Panel -->
                <aside class="inspector-panel" aria-labelledby="inspector-heading">
                    <!-- Style selector -->
                    <div class="control-group">
                        <label class="control-label" id="style-label">Style</label>
                        <div class="style-pills" role="radiogroup" aria-labelledby="style-label">
                            <div class="style-pill active" role="radio" aria-checked="true" tabindex="0" data-style="manga">Manga</div>
                            <div class="style-pill" role="radio" aria-checked="false" tabindex="0" data-style="noir">Noir</div>
                            <div class="style-pill" role="radio" aria-checked="false" tabindex="0" data-style="scifi">Sci-Fi</div>
                        </div>
                    </div>

                    <!-- Prompt input -->
                    <div class="control-group">
                        <label class="control-label" for="prompt-input">Prompt</label>
                        <textarea 
                            id="prompt-input" 
                            class="prompt-input" 
                            placeholder="A cybernetic warrior with glowing blue armor in a neon city. A cybernetic warrior glowing blue armor in a neon city..."
                            aria-label="Character prompt">A cybernetic warrior with glowing blue armor in a neon city. A cybernetic warrior glowing blue armor in a neon city...</textarea>
                    </div>

                    <!-- Negative prompt -->
                    <div class="control-group">
                        <label class="control-label" for="negative-prompt-input">Negative prompt</label>
                        <textarea 
                            id="negative-prompt-input" 
                            class="negative-prompt-input" 
                            placeholder="Negative prompt for everyone..."
                            aria-label="Negative prompt"></textarea>
                    </div>

                    <!-- Line Weight slider -->
                    <div class="control-group">
                        <label class="control-label" for="line-weight-slider">Line Weight</label>
                        <input 
                            type="range" 
                            id="line-weight-slider" 
                            class="slider-input slider-control" 
                            min="0" 
                            max="100" 
                            value="50"
                            aria-label="Line weight control">
                    </div>

                    <!-- Contrast slider -->
                    <div class="control-group">
                        <label class="control-label" for="contrast-slider">Contrast</label>
                        <input 
                            type="range" 
                            id="contrast-slider" 
                            class="slider-input slider-control" 
                            min="0" 
                            max="100" 
                            value="50"
                            aria-label="Contrast control">
                    </div>

                    <!-- Neon Accent Intensity slider -->
                    <div class="control-group">
                        <label class="control-label" for="neon-slider">Neon Accent Intensity</label>
                        <input 
                            type="range" 
                            id="neon-slider" 
                            class="slider-input slider-control" 
                            min="0" 
                            max="100" 
                            value="70"
                            aria-label="Neon accent intensity control">
                    </div>

                    <!-- Upload reference images -->
                    <div class="control-group">
                        <label class="control-label">Upload for reference images</label>
                        <div class="upload-area" role="group" aria-label="Reference image uploads">
                            <div class="upload-slot empty" tabindex="0" role="button" aria-label="Upload reference image 1"></div>
                            <div class="upload-slot" tabindex="0" role="button" aria-label="Reference image 2">
                                <img src="https://im.runware.ai/image/ws/2/ii/8cf60bf6-56d6-4cd0-a086-1a4eb000d555.jpg" alt="Reference image 2">
                            </div>
                            <div class="upload-slot" tabindex="0" role="button" aria-label="Reference image 3">
                                <img src="https://im.runware.ai/image/ws/2/ii/ef549fac-1013-4e1e-ac13-e1eab2744bc5.jpg" alt="Reference image 3">
                            </div>
                        </div>
                    </div>

                    <!-- Preview panel -->
                    <div class="control-group">
                        <div class="preview-panel" data-pf="preview">
                            <div class="preview-header">
                                <span class="preview-title">Preview</span>
                                <span class="status-badge">Completed</span>
                            </div>
                            <div class="preview-image-container">
                                <img src="https://im.runware.ai/image/ws/2/ii/ef549fac-1013-4e1e-ac13-e1eab2744bc5.jpg" alt="Character preview">
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </main>

    <script>
        (function () {
            'use strict';

            // Minimal public app API attached to window.app
            window.app = (function () {
                var doc = document;

                // Helper: dispatch contract events
                function emit(eventName, detail) {
                    try {
                        var ev = new CustomEvent(eventName, { detail: detail });
                        doc.dispatchEvent(ev);
                    } catch (e) {
                        // older browsers fallback
                        var ev2 = document.createEvent('CustomEvent');
                        ev2.initCustomEvent(eventName, true, true, detail);
                        doc.dispatchEvent(ev2);
                    }
                }

                // Highlight nav link by data-nav-key, manage aria-current and .is-active
                function highlightActiveNav(pathKey) {
                    var navLinks = doc.querySelectorAll('[data-pf="nav"] [data-pf="nav-link"]');
                    navLinks.forEach(function (lnk) {
                        var key = lnk.getAttribute('data-nav-key');
                        if (key === pathKey) {
                            lnk.setAttribute('aria-current', 'page');
                            lnk.classList.add('is-active');
                        } else {
                            // remove only contract state, preserve visual .active class if present
                            if (lnk.hasAttribute('aria-current')) {
                                lnk.removeAttribute('aria-current');
                            }
                            lnk.classList.remove('is-active');
                        }
                    });
                    emit('pf:nav:activated', { key: pathKey });
                }

                // Toggle mobile menu placeholder
                function toggleMobileMenu() {
                    var btn = doc.querySelector('[data-pf="mobile-toggle"]');
                    var menu = doc.querySelector('#pf-mobile-menu');
                    if (!btn || !menu) return;

                    var willOpen = !menu.classList.contains('is-open');
                    menu.classList.toggle('is-open', willOpen);
                    menu.setAttribute('aria-hidden', (!willOpen).toString());
                    btn.setAttribute('aria-expanded', willOpen.toString());
                }

                // Activate a card by cardId (data-card-id)
                function activateCard(cardId) {
                    if (!cardId) return;
                    var cards = doc.querySelectorAll('[data-pf="card"]');
                    var target = null;
                    cards.forEach(function (c) {
                        var id = c.getAttribute('data-card-id');
                        if (id === cardId) {
                            target = c;
                        }
                    });
                    if (!target) return;

                    cards.forEach(function (c) {
                        c.classList.remove('selected');
                        c.classList.remove('is-active');
                        c.setAttribute('aria-selected', 'false');
                        c.setAttribute('aria-pressed', 'false');
                    });

                    target.classList.add('selected'); // preserve existing visual class
                    target.classList.add('is-active'); // contract state class
                    target.setAttribute('aria-selected', 'true');
                    target.setAttribute('aria-pressed', 'true');

                    emit('pf:card:activated', { cardId: cardId });
                }

                // Show export modal placeholder
                function showexportModal() {
                    document.body.classList.add('is-exporting');
                }

                function hideexportModal() {
                    document.body.classList.remove('is-exporting');
                }

                // Initialization: bind events and set initial states
                function init(rootDocument) {
                    doc = rootDocument || document;

                    // Nav link clicks
                    var navLinks = doc.querySelectorAll('[data-pf="nav"] [data-pf="nav-link"]');
                    navLinks.forEach(function (lnk) {
                        lnk.addEventListener('click', function (e) {
                            var key = lnk.getAttribute('data-nav-key');
                            if (key) {
                                highlightActiveNav(key);
                            }
                        });
                    });

                    // Map current location to nav key and highlight
                    try {
                        var filename = (doc.location && doc.location.pathname) ? doc.location.pathname.split('/').pop() : '';
                        if (!filename) filename = 'index.html';
                        var matchedKey = null;
                        navLinks.forEach(function (lnk) {
                            try {
                                var href = lnk.getAttribute('href') || '';
                                var linkFile = href.split('/').pop();
                                if (linkFile === filename) {
                                    var k = lnk.getAttribute('data-nav-key');
                                    if (k) matchedKey = k;
                                }
                            } catch (e) { /* ignore */ }
                        });
                        if (matchedKey) {
                            highlightActiveNav(matchedKey);
                        }
                    } catch (e) { /* ignore */ }

                    // Character cards: bind click/keyboard
                    var characterCards = doc.querySelectorAll('[data-pf="card"]');
                    characterCards.forEach(function (card) {
                        // ensure tabindex and role remain as-is
                        card.addEventListener('click', function () {
                            var id = card.getAttribute('data-card-id') || card.getAttribute('data-character');
                            activateCard(id);
                        });
                        card.addEventListener('keydown', function (e) {
                            if (e.key === 'Enter' || e.key === ' ') {
                                e.preventDefault();
                                var id = card.getAttribute('data-card-id') || card.getAttribute('data-character');
                                activateCard(id);
                            }
                        });
                    });

                    // Initialize first character as selected (preserve previous behavior)
                    if (characterCards.length > 0) {
                        var firstId = characterCards[0].getAttribute('data-card-id') || characterCards[0].getAttribute('data-character');
                        activateCard(firstId);
                    }

                    // Style pill selection (unchanged behavior)
                    var stylePills = doc.querySelectorAll('.style-pill');
                    function selectStyle(pill) {
                        stylePills.forEach(function (p) {
                            p.classList.remove('active');
                            p.setAttribute('aria-checked', 'false');
                        });
                        pill.classList.add('active');
                        pill.setAttribute('aria-checked', 'true');
                    }
                    stylePills.forEach(function (pill) {
                        pill.addEventListener('click', function () {
                            selectStyle(this);
                        });
                        pill.addEventListener('keydown', function (e) {
                            if (e.key === 'Enter' || e.key === ' ') {
                                e.preventDefault();
                                selectStyle(this);
                            }
                        });
                    });

                    // Upload slot interactions
                    var uploadSlots = doc.querySelectorAll('.upload-slot');
                    uploadSlots.forEach(function (slot) {
                        slot.addEventListener('click', function () {
                            if (this.classList.contains('empty')) {
                                alert('File upload dialog would open here');
                            }
                        });
                        slot.addEventListener('keydown', function (e) {
                            if (e.key === 'Enter' || e.key === ' ') {
                                e.preventDefault();
                                this.click();
                            }
                        });
                    });

                    // Sliders ARIA init
                    var sliders = doc.querySelectorAll('.slider-input');
                    sliders.forEach(function (slider) {
                        slider.addEventListener('input', function () {
                            this.setAttribute('aria-valuenow', this.value);
                        });
                        slider.setAttribute('aria-valuenow', slider.value);
                        slider.setAttribute('aria-valuemin', slider.min);
                        slider.setAttribute('aria-valuemax', slider.max);
                    });

                    // Generate button
                    var generateBtn = doc.querySelector('.btn-header');
                    if (generateBtn) {
                        generateBtn.addEventListener('click', function () {
                            alert('Generating character with current settings...');
                        });
                    }

                    // Keyboard navigation for character grid (keeps previous approach)
                    var cardArray = Array.from(characterCards);
                    doc.addEventListener('keydown', function (e) {
                        if (!doc.activeElement || !doc.activeElement.classList.contains('character-card')) {
                           ?[TRUNCATED]
